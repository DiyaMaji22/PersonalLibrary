<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Details</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'gruvbox-bg': '#282828',
                        'gruvbox-bg-soft': '#32302f',
                        'gruvbox-fg': '#ebdbb2',
                        'gruvbox-red': '#cc241d',
                        'gruvbox-green': '#98971a',
                        'gruvbox-yellow': '#d79921',
                        'gruvbox-blue': '#458588',
                        'gruvbox-purple': '#b16286',
                        'gruvbox-aqua': '#689d6a',
                        'gruvbox-orange': '#d65d0e',
                        'gruvbox-gray': '#928374',
                        'gruvbox-light-bg': '#3c3836',
                        'gruvbox-lighter-bg': '#504945',
                    }
                }
            }
        }
    </script>
</head>

<body class="bg-gruvbox-bg min-h-screen py-8 flex justify-center items-center">
    <!-- Back Navigation -->
    <div class="fixed top-4 left-4 z-20">
        <a href="../../index.html" class="flex items-center gap-2 px-4 py-2 bg-gruvbox-bg-soft hover:bg-gruvbox-light-bg text-gruvbox-fg rounded-lg border border-gruvbox-gray transition-colors">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
            </svg>
            Back to Home
        </a>
    </div>
    <!-- Search Bar -->
    <div class="fixed top-4 left-1/2 transform -translate-x-1/2 z-10">
        <div class="bg-gruvbox-bg-soft rounded-lg shadow-lg border border-gruvbox-lighter-bg p-4">
            <div class="flex gap-2">
                <input type="text" id="bookSearchInput"
                    placeholder="Search for a book (e.g., 'Pride and Prejudice Jane Austen')"
                    class="px-4 py-2 bg-gruvbox-light-bg text-gruvbox-fg border border-gruvbox-gray rounded-lg focus:outline-none focus:border-gruvbox-blue w-80">
                <button id="searchBtn"
                    class="px-6 py-2 bg-gruvbox-blue hover:bg-gruvbox-aqua text-gruvbox-fg font-semibold rounded-lg transition-colors">
                    Search
                </button>
            </div>
        </div>
    </div>

    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 mt-20">
        <div class="bg-gruvbox-bg-soft rounded-xl shadow-lg overflow-hidden border border-gruvbox-lighter-bg">
            <div class="flex flex-col lg:flex-row">
                <!-- Book Image Section -->
                <div class="lg:w-1/3 p-6 lg:p-8">
                    <div class="sticky top-8">
                        <div
                            class="aspect-[3/4] bg-gruvbox-lighter-bg rounded-lg overflow-hidden mb-4 border border-gruvbox-gray">
                            <img id="bookImage" src="../../public/assets/books/agathacristie/murderonorient.jpg" alt="Book Cover"
                                class="w-full h-full object-cover">
                        </div>

                        <!-- Action Buttons -->
                        <div class="space-y-3">
                            <button
                                class="w-full bg-gruvbox-green hover:bg-green-700 text-gruvbox-bg font-semibold py-3 px-6 rounded-lg transition-colors">
                                Want to Read
                            </button>
                            <button
                                class="w-full border-2 border-gruvbox-gray hover:border-gruvbox-fg text-gruvbox-fg font-semibold py-3 px-6 rounded-lg transition-colors hover:bg-gruvbox-light-bg">
                                Buy on Amazon
                            </button>
                        </div>

                        <!-- Rating Section -->
                        <div class="mt-6 text-center">
                            <div class="flex justify-center mb-2">
                                <div class="flex space-x-1" id="starRating">
                                    <!-- Stars will be generated by JavaScript --> 
</div>
</div>
                            <p class="text-sm text-gruvbox-gray">Rate this book</p>
                        </div> 
                    </div>
                </div>

                <!-- Book Details Section -->
                <div class="lg:w-2/3 p-6 lg:p-8">
                    <div class="mb-4">
                        <h1 id="bookTitle" class="text-3xl lg:text-4xl font-bold text-gruvbox-fg mb-2">
                            Murder On The Orient Express
                        </h1>
                        <p id="authorName" class="text-lg text-gruvbox-gray mb-4">
                            Agatha Christie
                        </p>

                        <!-- Rating and Stats -->
                        <div class="flex items-center gap-4 mb-6">
                            <div class="flex items-center">
                                <div class="flex text-gruvbox-yellow mr-2" id="displayStars">
                                    <!-- Display stars will be generated by JavaScript -->
                                </div>
                                <span id="ratingScore" class="text-xl font-semibold text-gruvbox-fg">4.5</span>
                            </div>
                            <span id="ratingCount" class="text-gruvbox-gray">33,549 ratings</span>
                        </div>
                    </div>

                    <!-- Book Description -->
                    <div class="mb-6">
                        <p id="bookDescription" class="text-gruvbox-fg leading-relaxed text-base">

                        </p>
                        <button id="showMoreBtn"
                            class="text-gruvbox-blue hover:text-gruvbox-aqua font-medium mt-2 transition-colors">
                            Show more
                        </button>
                    </div>

                    <!-- Genres -->
                    <div class="mb-6">
                        <p class="text-sm text-gruvbox-gray mb-2">Genres</p>
                        <div class="flex flex-wrap gap-2" id="genreContainer">
                            <!-- Genres will be generated by JavaScript -->
                        </div>
                    </div>

                    <!-- Book Info -->
                    <div class="mb-6">
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm">
                            <div>
                                <span class="text-gruvbox-gray">Pages:</span>
                                <span id="pageCount" class="ml-2 text-gruvbox-fg">295 pages, ebook</span>
                            </div>
                            <div>
                                <span class="text-gruvbox-gray">First published:</span>
                                <span id="publishDate" class="ml-2 text-gruvbox-fg">January 1, 2009</span>
                            </div>
                        </div>
                    </div>


                    <!-- About the Author -->
                    <div class="border-t border-gruvbox-lighter-bg pt-6 mt-6">
                        <h3 class="text-xl font-semibold text-gruvbox-fg mb-4">About the author</h3>
                        <div class="flex items-start gap-4">
                            <div
                                class="w-16 h-16 bg-gruvbox-lighter-bg rounded-full flex-shrink-0 overflow-hidden border border-gruvbox-gray">
                                <img id="authorImage" src="../../public/assets/books/agathacristie/theauthor.jpg" alt="Author"
                                    class="w-full h-full object-cover">
                            </div>
                            <div class="flex-1">
                                <div class="flex items-center justify-between mb-2">
                                    <h4 id="authorNameFull" class="font-semibold text-gruvbox-fg">Agatha Christie</h4>
                                </div>
                                <p class="text-sm text-gruvbox-gray mb-2">
                                    <span id="bookCount">60+</span>
                                </p>
                                <p id="authorBio" class="text-sm text-gruvbox-fg leading-relaxed">
                                    Born in Torquay in 1890, Agatha Christie began writing during the First World War
                                    and wrote over 100 novels, plays and
                                    short story collections. She was still writing to great acclaim until her death, and
                                    her books have now sold over a
                                    billion copies in English and another billion in over 100 foreign languages. Yet
                                    Agatha Christie was always a very
                                    private person, and though Hercule Poirot and Miss Marple became household names,
                                    the Queen of Crime was a complete
                                    enigma to all but her closest friends.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function () {
            // Load book data for "Murder on the Orient Express" by default
            searchAndLoadBook('Murder on the Orient Express Agatha Christie');

            // Note: generateStars() is not called here because stars will be generated by the API
            generateGenres();
            setupShowMore();
            setupBookSearch();
        });

        // Setup book search functionality
        function setupBookSearch() {
            const searchInput = document.getElementById('bookSearchInput');
            const searchBtn = document.getElementById('searchBtn');

            searchBtn.addEventListener('click', function () {
                const query = searchInput.value.trim();
                if (query) {
                    searchAndLoadBook(query);
                }
            });

            searchInput.addEventListener('keypress', function (e) {
                if (e.key === 'Enter') {
                    const query = searchInput.value.trim();
                    if (query) {
                        searchAndLoadBook(query);
                    }
                }
            });
        }

        // Google Books API functions
        async function searchAndLoadBook(query) {
            // Show loading state
            showLoadingState();

            try {
                // Use Google Books API v1
                const response = await fetch(`https://www.googleapis.com/books/v1/volumes?q=${encodeURIComponent(query)}&maxResults=10`);

                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }

                const data = await response.json();

                if (data.items && data.items.length > 0) {
                    // Find the best result - prioritize the original Agatha Christie book
                    let selectedBook = data.items[0]; // Default to first result

                    // First, look for the original Agatha Christie version
                    for (let i = 0; i < data.items.length; i++) {
                        const book = data.items[i];
                        const info = book.volumeInfo;

                        // Look for the original book by Agatha Christie with good data
                        if (info.authors && info.authors.length > 0 &&
                            info.authors[0].toLowerCase().includes('agatha christie') &&
                            info.title.toLowerCase().includes('murder') &&
                            info.title.toLowerCase().includes('orient express') &&
                            !info.title.toLowerCase().includes('graphic') &&
                            !info.title.toLowerCase().includes('adaptation')) {
                            selectedBook = book;
                            break;
                        }
                    }

                    // If we didn't find the original, look for any version with rating data
                    if (selectedBook === data.items[0]) {
                        for (let i = 0; i < data.items.length; i++) {
                            const book = data.items[i];
                            if (book.volumeInfo.averageRating && book.volumeInfo.ratingsCount) {
                                selectedBook = book;
                                break;
                            }
                        }
                    }

                    updateBookDataFromAPI(selectedBook);
                } else {
                    showErrorState('No books found for that search query.');
                }
            } catch (error) {
                console.error('Error fetching book data:', error);
                showErrorState('Error fetching book data. Please try again.');
            }
        }

        function showLoadingState() {
            document.getElementById('bookTitle').textContent = 'Loading...';
            document.getElementById('authorName').textContent = 'Searching for book...';
            document.getElementById('bookDescription').textContent = 'Please wait while we fetch book information.';
            document.getElementById('authorNameFull').textContent = 'Loading author...';
            document.getElementById('authorBio').textContent = 'Loading author information...';
            document.getElementById('bookCount').textContent = 'Loading...';
            document.getElementById('ratingScore').textContent = '0.0';
            document.getElementById('ratingCount').textContent = 'Loading ratings...';

            // Clear existing content
            document.getElementById('genreContainer').innerHTML = '';
            document.getElementById('displayStars').innerHTML = '';
            document.getElementById('starRating').innerHTML = '';
        }

        function showErrorState(message) {
            document.getElementById('bookTitle').textContent = 'Book Not Found';
            document.getElementById('authorName').textContent = 'Unknown Author';
            document.getElementById('bookDescription').textContent = message;
            document.getElementById('ratingScore').textContent = '0.0';
            document.getElementById('ratingCount').textContent = '0 ratings';
            document.getElementById('pageCount').textContent = 'Unknown pages';
            document.getElementById('publishDate').textContent = 'Unknown';
            document.getElementById('authorNameFull').textContent = 'Unknown Author';
            document.getElementById('authorBio').textContent = 'No author information available.';
            document.getElementById('bookCount').textContent = '0 books';
        }

        async function updateBookDataFromAPI(book) {
            const volumeInfo = book.volumeInfo;
            const saleInfo = book.saleInfo;

            // Update title
            if (volumeInfo.title) {
                document.getElementById('bookTitle').textContent = volumeInfo.title;
            }

            // Update author
            if (volumeInfo.authors && volumeInfo.authors.length > 0) {
                const authorName = volumeInfo.authors[0];
                document.getElementById('authorName').textContent = authorName;
                document.getElementById('authorNameFull').textContent = authorName;
            }

            // Update description
            if (volumeInfo.description) {
                const description = volumeInfo.description.replace(/<[^>]*>/g, ''); // Remove HTML tags
                const shortDescription = description.length > 300 ?
                    description.substring(0, 300) + '...' : description;
                document.getElementById('bookDescription').textContent = shortDescription;

                // Store full description for show more functionality
                document.getElementById('bookDescription').setAttribute('data-full', description);
                document.getElementById('bookDescription').setAttribute('data-short', shortDescription);
            }

            // Update rating
            
             if (volumeInfo.averageRating && volumeInfo.ratingsCount) {
                const rating = volumeInfo.averageRating;
                document.getElementById('ratingScore').textContent = rating.toFixed(1);
                document.getElementById('ratingCount').textContent = `${volumeInfo.ratingsCount.toLocaleString()} ratings`;
                updateDisplayStars(rating);
                updateInteractiveStars(rating);
            } else if (volumeInfo.averageRating) {
                const rating = volumeInfo.averageRating;
                document.getElementById('ratingScore').textContent = rating.toFixed(1);
                document.getElementById('ratingCount').textContent = 'Rating available';
                updateDisplayStars(rating);
                updateInteractiveStars(rating);
            } else {
                const defaultRating = 4.0;
                document.getElementById('ratingScore').textContent = defaultRating.toFixed(1);
                document.getElementById('ratingCount').textContent = 'No ratings available';
                updateDisplayStars(defaultRating);
                updateInteractiveStars(defaultRating);
            } 


            // Update page count
            if (volumeInfo.pageCount) {
                const format = saleInfo && saleInfo.isEbook ? 'ebook' : 'book';
                document.getElementById('pageCount').textContent = `${volumeInfo.pageCount} pages, ${format}`;
            }

            // Update publish date
            if (volumeInfo.publishedDate) {
                const date = new Date(volumeInfo.publishedDate);
                const formattedDate = date.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                document.getElementById('publishDate').textContent = formattedDate;
            }

            // Update cover image
            if (volumeInfo.imageLinks) {
                let imageUrl = volumeInfo.imageLinks.thumbnail ||
                    volumeInfo.imageLinks.smallThumbnail ||
                    volumeInfo.imageLinks.large ||
                    volumeInfo.imageLinks.medium;

                if (imageUrl) {
                    // Ensure HTTPS
                    imageUrl = imageUrl.replace('http:', 'https:');
                    // Get higher resolution image
                    imageUrl = imageUrl.replace('&zoom=1', '&zoom=2');
                    document.getElementById('bookImage').src = imageUrl;
                }
            }

            // Update genres from categories
            if (volumeInfo.categories && volumeInfo.categories.length > 0) {
                updateGenresFromAPI(volumeInfo.categories);
            } else {
                // Use fallback genres
                generateGenres();
            }

            // Update author bio with publisher info if available
            await updateAuthorInformation(volumeInfo);
        }

        async function updateAuthorInformation(volumeInfo) {
            // Update author name first
            if (volumeInfo.authors && volumeInfo.authors.length > 0) {
                const authorName = volumeInfo.authors[0];
                document.getElementById('authorNameFull').textContent = authorName;

                console.log('Fetching author details for:', authorName);

                // Try to get more author information with multiple search strategies
                try {
                    await fetchAuthorDetails(authorName);

                    // If that didn't work well, try a more specific search for biographical info
                    const currentBio = document.getElementById('authorBio').textContent;
                    if (currentBio.includes('is the author of this book') || currentBio.includes('is a renowned author')) {
                        console.log('Trying biographical search for more detailed info...');
                        await fetchAuthorBiography(authorName);
                    }
                } catch (error) {
                    console.log('Could not fetch additional author details:', error);
                    // Fallback to basic info from book data
                    updateAuthorFallback(volumeInfo);
                }
            } else {
                // No author information available
                document.getElementById('authorNameFull').textContent = 'Unknown Author';
                document.getElementById('authorBio').textContent = 'No author information available.';
                document.getElementById('bookCount').textContent = '0 books';
            }
        }

        async function fetchAuthorBiography(authorName) {
            try {
                console.log('Searching for biographical information about:', authorName);

                // Try a more specific search for biographical content
                const queries = [
                    `"${authorName}" biography`,
                    `"${authorName}" author biography`,
                    `"${authorName}" life born`
                ];

                for (const query of queries) {
                    console.log('Trying query:', query);
                    const response = await fetch(`https://www.googleapis.com/books/v1/volumes?q=${encodeURIComponent(query)}&maxResults=20`);

                    if (response.ok) {
                        const data = await response.json();

                        if (data.items && data.items.length > 0) {
                            for (const item of data.items) {
                                if (item.volumeInfo.description) {
                                    const description = item.volumeInfo.description.replace(/<[^>]*>/g, '');

                                    // Look for biographical content mentioning the author
                                    if (description.toLowerCase().includes(authorName.toLowerCase()) &&
                                        (description.toLowerCase().includes('born') ||
                                            description.toLowerCase().includes('life') ||
                                            description.toLowerCase().includes('biography') ||
                                            description.toLowerCase().includes('career'))) {

                                        document.getElementById('authorBio').textContent = description.substring(0, 400) + '...';
                                        console.log('Found biographical information from query:', query);
                                        return; // Success, exit function
                                    }
                                }
                            }
                        }
                    }
                }

                console.log('No biographical information found through specific searches');
            } catch (error) {
                console.error('Error in biographical search:', error);
            }
        }

        async function fetchAuthorDetails(authorName) {
            try {
                console.log('Searching for author books:', authorName);

                // Search for books by this author to get more information
                const response = await fetch(`https://www.googleapis.com/books/v1/volumes?q=inauthor:"${encodeURIComponent(authorName)}"&maxResults=40`);

                if (!response.ok) {
                    throw new Error('Failed to fetch author details');
                }

                const data = await response.json();
                console.log('Author search results:', data);
                console.log('Number of books found:', data.items ? data.items.length : 0);

                if (data.items && data.items.length > 0) {
                    // Count unique books by this author
                    const uniqueBooks = new Set();
                    let authorBio = '';
                    let authorImage = '';
                    let bestDescription = '';

                    data.items.forEach((item, index) => {
                        console.log(`Book ${index + 1}:`, item.volumeInfo.title);

                        if (item.volumeInfo.title) {
                            uniqueBooks.add(item.volumeInfo.title);
                        }

                        // Look for author image
                        if (!authorImage && item.volumeInfo.imageLinks && item.volumeInfo.imageLinks.thumbnail) {
                            authorImage = item.volumeInfo.imageLinks.thumbnail.replace('http:', 'https:');
                        }

                        // Look for biographical information in descriptions
                        if (item.volumeInfo.description) {
                            const description = item.volumeInfo.description.replace(/<[^>]*>/g, '');
                            console.log(`Description ${index + 1}:`, description.substring(0, 100) + '...');

                            // Keep the longest description as backup
                            if (description.length > bestDescription.length) {
                                bestDescription = description;
                            }

                            // Look for biographical keywords
                            if (!authorBio && (
                                description.toLowerCase().includes('agatha christie') ||
                                description.toLowerCase().includes('born in') ||
                                description.toLowerCase().includes('author of') ||
                                description.toLowerCase().includes('novelist') ||
                                description.toLowerCase().includes('wrote') ||
                                description.toLowerCase().includes('created') ||
                                description.toLowerCase().includes('detective fiction') ||
                                description.toLowerCase().includes('mystery writer'))) {
                                authorBio = description.substring(0, 400) + '...';
                                console.log('Found biographical info in book:', item.volumeInfo.title);
                            }
                        }
                    });

                    // Update book count
                    const bookCount = uniqueBooks.size;
                    document.getElementById('bookCount').textContent = `${bookCount}+ books`;
                    console.log('Found', bookCount, 'unique books by', authorName);

                    // Update author bio
                    if (authorBio) {
                        document.getElementById('authorBio').textContent = authorBio;
                        console.log('Updated author bio from search results');
                    } else if (bestDescription.length > 100) {
                        // Use the best description we found, even if it doesn't have biographical keywords
                        document.getElementById('authorBio').textContent = bestDescription.substring(0, 350) + '...';
                        console.log('Updated author bio with best available description');
                    } else {
                        // Create a basic bio
                        document.getElementById('authorBio').textContent = `${authorName} is a celebrated author known for works including "Murder on the Orient Express" and other mystery novels. With ${bookCount}+ published works, ${authorName} has made significant contributions to detective fiction.`;
                        console.log('Used fallback biographical text');
                    }

                    // Update author image if found
                    if (authorImage) {
                        document.getElementById('authorImage').src = authorImage;
                        console.log('Updated author image from search results');
                    }
                } else {
                    // No additional books found, use fallback
                    document.getElementById('bookCount').textContent = '1+ books';
                    document.getElementById('authorBio').textContent = `${authorName} is the author of this book.`;
                    console.log('No additional books found for', authorName);
                }
            } catch (error) {
                console.error('Error fetching author details:', error);
                // Use fallback information
                document.getElementById('bookCount').textContent = '1+ books';
                document.getElementById('authorBio').textContent = `${authorName} is the author of this book.`;
            }
        }

        function updateAuthorFallback(volumeInfo) {
            // Use basic information from the current book
            if (volumeInfo.publisher) {
                document.getElementById('authorBio').textContent = `Published by ${volumeInfo.publisher}.`;
            }

            if (volumeInfo.publishedDate) {
                const year = new Date(volumeInfo.publishedDate).getFullYear();
                const currentBio = document.getElementById('authorBio').textContent;
                document.getElementById('authorBio').textContent = currentBio + ` Book published in ${year}.`;
            }

            document.getElementById('bookCount').textContent = '1+ books';
        }

        function updateDisplayStars(rating) {
            const displayStars = document.getElementById('displayStars');
            displayStars.innerHTML = ''; // Clear existing stars

            const maxStars = 5;
            for (let i = 1; i <= maxStars; i++) {
                const star = document.createElement('span');
                if (i <= Math.floor(rating)) {
                    star.className = 'text-gruvbox-yellow';
                } else if (i - 0.5 <= rating) {
                    star.className = 'text-gruvbox-yellow';
                    star.innerHTML = '☆'; // Half star representation
                } else {
                    star.className = 'text-gruvbox-gray';
                }
                if (star.innerHTML !== '☆') {
                    star.innerHTML = '★';
                }
                displayStars.appendChild(star);
            }
        }

        function updateInteractiveStars(rating) {
            const starRating = document.getElementById('starRating');
            starRating.innerHTML = ''; // Clear existing interactive stars

            const maxStars = 5;
            const currentRating = Math.round(rating); // Round to nearest whole number for interactive stars

            // Generate interactive stars for rating
            for (let i = 1; i <= maxStars; i++) {
                const star = document.createElement('button');
                star.className = i <= currentRating ?
                    'text-2xl text-gruvbox-yellow hover:text-gruvbox-orange transition-colors' :
                    'text-2xl text-gruvbox-gray hover:text-gruvbox-yellow transition-colors';
                star.innerHTML = '★';
                star.addEventListener('click', () => setRating(i));
                starRating.appendChild(star);
            }
        }

        function updateGenresFromAPI(categories) {
            const container = document.getElementById('genreContainer');
            container.innerHTML = ''; // Clear existing genres

            // Process and clean up categories
            const genres = categories.map(category => {
                // Split by '/' and take relevant parts
                return category.split('/').map(part => part.trim());
            }).flat().slice(0, 8); // Limit to 8 genres

            genres.forEach(genre => {
                const tag = document.createElement('span');
                tag.className = 'px-3 py-1 bg-gruvbox-light-bg hover:bg-gruvbox-lighter-bg text-gruvbox-fg text-sm rounded-full transition-colors cursor-pointer border border-gruvbox-gray';
                tag.textContent = genre;
                container.appendChild(tag);
            });
        }

        // Function to search for a different book
        function searchBook(title, author = '') {
            const query = author ? `${title} ${author}` : title;
            searchAndLoadBook(query);
        }

        // Generate star ratings (fallback if API doesn't provide ratings)
        function generateStars(rating = 4.0) {
            const starRating = document.getElementById('starRating');
            const displayStars = document.getElementById('displayStars');

            // Only generate if stars don't already exist
            if (starRating.children.length === 0) {
                const maxStars = 5;

                // Generate interactive stars for rating
                for (let i = 1; i <= maxStars; i++) {
                    const star = document.createElement('button');
                    star.className = i <= Math.round(rating) ?
                        'text-2xl text-gruvbox-yellow hover:text-gruvbox-orange transition-colors' :
                        'text-2xl text-gruvbox-gray hover:text-gruvbox-yellow transition-colors';
                    star.innerHTML = '★';
                    star.addEventListener('click', () => setRating(i));
                    starRating.appendChild(star);
                }
            }

            // Only generate display stars if they don't exist
            if (displayStars.children.length === 0) {
                const maxStars = 5;
                for (let i = 1; i <= maxStars; i++) {
                    const star = document.createElement('span');
                    star.className = i <= Math.floor(rating) ? 'text-gruvbox-yellow' : 'text-gruvbox-gray';
                    star.innerHTML = '★';
                    displayStars.appendChild(star);
                }
            }
        }

        // Set rating
        function setRating(rating) {
            const stars = document.querySelectorAll('#starRating button');
            stars.forEach((star, index) => {
                star.className = index < rating ?
                    'text-2xl text-gruvbox-yellow hover:text-gruvbox-orange transition-colors' :
                    'text-2xl text-gruvbox-gray hover:text-gruvbox-yellow transition-colors';
            });
        }

        // Generate genre tags (fallback if API doesn't provide genres)
        function generateGenres() {
            const container = document.getElementById('genreContainer');

            // Only generate default genres if container is empty
            if (container.children.length === 0) {
                const genres = ['Mystery', 'Crime', 'Fiction', 'Classic', 'Detective', 'Thriller'];

                genres.forEach(genre => {
                    const tag = document.createElement('span');
                    tag.className = 'px-3 py-1 bg-gruvbox-light-bg hover:bg-gruvbox-lighter-bg text-gruvbox-fg text-sm rounded-full transition-colors cursor-pointer border border-gruvbox-gray';
                    tag.textContent = genre;
                    container.appendChild(tag);
                });
            }
        }

        // Setup show more functionality
        function setupShowMore() {
            const showMoreBtn = document.getElementById('showMoreBtn');
            const description = document.getElementById('bookDescription');
            let isExpanded = false;

            showMoreBtn.addEventListener('click', function () {
                const fullDescription = description.getAttribute('data-full');
                const shortDescription = description.getAttribute('data-short');

                if (!isExpanded && fullDescription) {
                    description.textContent = fullDescription;
                    showMoreBtn.textContent = 'Show less';
                    isExpanded = true;
                } else if (shortDescription) {
                    description.textContent = shortDescription;
                    showMoreBtn.textContent = 'Show more';
                    isExpanded = false;
                }
            });
        }

        // Function to update book data (for dynamic content)
        function updateBookData(bookData) {
            document.getElementById('bookTitle').textContent = bookData.title || 'Book Title';
            document.getElementById('authorName').textContent = bookData.author || 'Author Name';
            document.getElementById('ratingScore').textContent = bookData.rating || '0.00';
            document.getElementById('ratingCount').textContent = `${bookData.ratingCount || 0} ratings`;
            document.getElementById('reviewCount').textContent = `${bookData.reviewCount || 0} reviews`;
            document.getElementById('bookDescription').textContent = bookData.description || 'Book description goes here...';
            document.getElementById('pageCount').textContent = `${bookData.pages || 0} pages, ${bookData.format || 'ebook'}`;
            document.getElementById('publishDate').textContent = bookData.publishDate || 'Unknown';
            document.getElementById('currentlyReading').textContent = `${bookData.currentlyReading || 0} people are currently reading`;
            document.getElementById('wantToRead').textContent = `${bookData.wantToRead || 0} people want to read`;
            document.getElementById('authorNameFull').textContent = bookData.author || 'Author Name';
            document.getElementById('bookCount').textContent = `${bookData.authorBooks || 0} books`;
            document.getElementById('followerCount').textContent = `${bookData.authorFollowers || 0} followers`;
            document.getElementById('authorBio').textContent = bookData.authorBio || 'Author biography goes here...';

            if (bookData.coverImage) {
                document.getElementById('bookImage').src = bookData.coverImage;
            }
            if (bookData.authorImage) {
                document.getElementById('authorImage').src = bookData.authorImage;
            }
        }

        // Example of how to use the update function
        // updateBookData({
        //    title: "New Book Title",
        //     author: "New Author",
        //     rating: 4.5,
        //     ratingCount: 1000,
        //     reviewCount: 150,
        //     description: "This is a new book description...",
        //     pages: 350,
        //     format: "hardcover",
        //     publishDate: "March 15, 2024",
        //     currentlyReading: 2500,
        //     wantToRead: 15000,
        //     authorBooks: 12,
        //     authorFollowers: 500,
        //     authorBio: "This author is amazing...",
        //     coverImage: "path/to/cover.jpg",
        //     authorImage: "path/to/author.jpg"
        // });
    </script>
</body>

</html>